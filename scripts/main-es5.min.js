"use strict";function fetchAutocomplete(e){var n=e.which||e.keyCode;if(n>=65&&n<=90||8==n||229==n){var t=this.value.trim();autocompleteList.innerHTML="",t.length<3||(autocompleteList.innerHTML="<li class='autocomplete-list-item loading-list'><i class='wi wi-day-sunny loading-autocomplete'></i></li>",fetch("https://api.openweathermap.org/data/2.5/find?q="+t+"&APPID="+apiKey,{method:"get"}).then(function(e){if(e.ok)return e.json();handleError()}).then(function(e){if(e.list.length)return e.list.map(function(e){return fetch("https://open.mapquestapi.com/geocoding/v1/reverse?key="+apiKey2+"&location="+e.coord.lat+","+e.coord.lon+"&includeNearestIntersection=true",{method:"get"}).then(function(e){if(e.ok)return e.json();handleError()}).then(function(n){return{location:n.results[0].locations[0],id:e.id}})});autocompleteList.innerHTML="<li class='error-info'>There is no such city</li>"}).then(function(e){e&&Promise.all(e).then(function(e){var n=e.map(function(e){var n="<p class='autocomplete-list-cityCountry'>"+e.location.adminArea5+", "+e.location.adminArea1+"</p>",t="<span class='autocomplete-list-state'>"+e.location.adminArea3+"</span>";return"<li class='autocomplete-list-item' data-id='"+e.id+"'>\n            "+n+t+"\n          </li>"}).join("");autocompleteList.innerHTML=n}).then(function(){document.querySelectorAll(".autocomplete-list-item").forEach(function(e){e.addEventListener("click",fetchWeatherData)})}).catch(function(){return handleError})}).catch(function(){return handleError}))}}function fetchWeatherData(){var e=this.dataset.id;autocompleteList.innerHTML="",appPrint.innerHTML="<i class='loading wi wi-day-sunny'></i>",fetch("https://api.openweathermap.org/data/2.5/weather?id="+e+"&APPID="+apiKey,{method:"get"}).then(function(e){if(e.ok)return e.json();handleError()}).then(function(e){var n=moment.unix(e.dt).format("h:mm a"),t=void 0;t=e.clouds.all<10?"one-num":e.clouds.all>=10&&100!=e.clouds.all?"two-num":"tree-num";var i='\n          <div class="main-icon-container">\n            <i class=\'wi wi-owm-'+e.weather[0].id+' main-icon\'></i>\n          </div>\n          <div class="current-weather">\n            <div class="current-temp">\n              <span class="current-temp-info"><i class=\'wi wi-thermometer thermometr-icon\'></i>'+(e.main.temp-273.15).toFixed(1)+'<i class=\'wi wi-degrees\'></i></span>\n              <p class="weather-text">Current temp.</p>\n            </div>\n            <div class="humidity-info">\n              <span class="weather-info">'+e.main.humidity+' <i class=\'wi wi-humidity humidity-icon\'></i></span>\n              <p class="weather-text">Humidity</p>\n            </div>\n            <div class="pressure-info">\n              <span class="weather-info">'+e.main.pressure+" hPa</span>\n              <p class=\"weather-text\">Pressure</p>\n            </div>\n          </div>\n          <p class='update-time'>Last update "+n+'</p>\n          <div class="clouds col-1-3">\n            <div class="clouds-icon-container">\n              <i class="wi wi-cloud clouds-icon"></i>\n              <span class="clouds-info-messure '+t+'">'+e.clouds.all+'</span>\n              <span class="clouds-info-prec">%</span>\n            </div>\n            <p class="weather-text">Cloudiness</p>\n          </div>\n          <div class="wind-status col-1-3">\n            <i class="wi wi-wind towards-0-deg wind-status-icon" style="transform: rotate('+e.wind.deg+'deg)"></i>\n            <p class="weather-text">Wind direction</p>\n          </div>\n          <div class="wind-speed col-1-3">\n            <div class="wind-speed-icon-container">\n              <i class="wi wi-strong-wind wind-speed-icon"></i>\n              <span class="wind-messure">'+e.wind.speed+'m/s</span>\n            </div>\n            <p class="weather-text">Wind speed</p>\n          </div>\n          <div class="forecast-container">\n            <h2 class="forecast-title">Forecast for next 5 days</h2>\n            <div class="forecast-days"></div>\n          </div>\n        ';return formInput.value=e.name+", "+e.sys.country,i}).then(function(e){return appPrint.innerHTML=e}).then(function(){var n=document.querySelector(".forecast-days");fetch("https://api.openweathermap.org/data/2.5/forecast?id="+e+"&APPID="+apiKey).then(function(e){return e.json()}).then(function(e){var t=e.list.filter(function(e){return"12:00:00"==e.dt_txt.split(" ")[1]}).map(function(e){return'<div class="forecast-day">\n                  <p class="dayOfWeek">'+moment.unix(e.dt).format("dddd")+"</p>\n                  <i class='wi wi-owm-"+e.weather[0].id+' daily-weather-icon\'></i>\n                  <p class="day-temp">'+(e.main.temp-273.15).toFixed(1)+"<i class='wi wi-degrees'></i></p>\n                </div>"}).join("");n.innerHTML=t})}).catch(function(e){return handleError})}function handleError(){autocompleteList.innerHTML="<li class='fetch-error'>Something went wrong</li>"}var apiKey="73855c7abb85af3fe9e6ae926705ff06",apiKey2="iNws003BsfzxWmZR16akCEz9FYqfOor3",appPrint=document.querySelector(".weather-info-container"),formInput=document.querySelector(".search-form-input"),form=document.querySelector(".search-form"),autocompleteList=document.querySelector(".autocomplete-list");formInput.addEventListener("keyup",fetchAutocomplete),form.addEventListener("submit",function(e){return e.preventDefault()});